<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Data Science Project Coding Standards</title>
  <meta name="description" content="Data Science Project Coding Standards">
  <meta name="generator" content="bookdown 0.3.16 and GitBook 2.6.7">

  <meta property="og:title" content="Data Science Project Coding Standards" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="datasciencecampus/coding-standards" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Science Project Coding Standards" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="python.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #2a211c; color: #bdae9d; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #2a211c; color: #bdae9d; border-right: 1px solid #bdae9d; }
td.sourceCode { padding-left: 5px; }
pre, code { color: #bdae9d; background-color: #2a211c; }
code > span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
code > span.dt { text-decoration: underline; } /* DataType */
code > span.dv { color: #44aa43; } /* DecVal */
code > span.bn { color: #44aa43; } /* BaseN */
code > span.fl { color: #44aa43; } /* Float */
code > span.ch { color: #049b0a; } /* Char */
code > span.st { color: #049b0a; } /* String */
code > span.co { color: #0066ff; font-style: italic; } /* Comment */
code > span.al { color: #ffff00; } /* Alert */
code > span.fu { color: #ff9358; font-weight: bold; } /* Function */
code > span.er { color: #ffff00; font-weight: bold; } /* Error */
code > span.wa { color: #ffff00; font-weight: bold; } /* Warning */
code > span.cn { } /* Constant */
code > span.sc { color: #049b0a; } /* SpecialChar */
code > span.vs { color: #049b0a; } /* VerbatimString */
code > span.ss { color: #049b0a; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { font-weight: bold; } /* Preprocessor */
code > span.at { } /* Attribute */
code > span.do { color: #0066ff; font-style: italic; } /* Documentation */
code > span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
code > span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
code > span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="rsrc\style\custom.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DSC Coding Standards</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="r.html"><a href="r.html"><i class="fa fa-check"></i><b>1</b> R</a><ul>
<li class="chapter" data-level="1.1" data-path="r.html"><a href="r.html#style"><i class="fa fa-check"></i><b>1.1</b> Programming Styles</a></li>
<li class="chapter" data-level="1.2" data-path="r.html"><a href="r.html#tools"><i class="fa fa-check"></i><b>1.2</b> Tools</a></li>
<li class="chapter" data-level="1.3" data-path="r.html"><a href="r.html#docs-r"><i class="fa fa-check"></i><b>1.3</b> Documentating Code</a></li>
<li class="chapter" data-level="1.4" data-path="r.html"><a href="r.html#tests-r"><i class="fa fa-check"></i><b>1.4</b> Testing</a></li>
<li class="chapter" data-level="1.5" data-path="r.html"><a href="r.html#coverage-r"><i class="fa fa-check"></i><b>1.5</b> Code Coverage</a></li>
<li class="chapter" data-level="1.6" data-path="r.html"><a href="r.html#package-r"><i class="fa fa-check"></i><b>1.6</b> Code Packaging</a></li>
<li class="chapter" data-level="1.7" data-path="r.html"><a href="r.html#deps-r"><i class="fa fa-check"></i><b>1.7</b> Dependency Management</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="python.html"><a href="python.html"><i class="fa fa-check"></i><b>2</b> Python</a><ul>
<li class="chapter" data-level="2.1" data-path="python.html"><a href="python.html#style-guide"><i class="fa fa-check"></i><b>2.1</b> Style guide</a></li>
<li class="chapter" data-level="2.2" data-path="python.html"><a href="python.html#package-management"><i class="fa fa-check"></i><b>2.2</b> Package Management</a><ul>
<li class="chapter" data-level="2.2.1" data-path="python.html"><a href="python.html#choosing-a-container"><i class="fa fa-check"></i><b>2.2.1</b> Choosing a container</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="other-languages.html"><a href="other-languages.html"><i class="fa fa-check"></i><b>3</b> Other Languages</a><ul>
<li class="chapter" data-level="3.1" data-path="other-languages.html"><a href="other-languages.html#haskell"><i class="fa fa-check"></i><b>3.1</b> Haskell</a></li>
<li class="chapter" data-level="3.2" data-path="other-languages.html"><a href="other-languages.html#java"><i class="fa fa-check"></i><b>3.2</b> Java</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="version-control.html"><a href="version-control.html"><i class="fa fa-check"></i><b>4</b> Version Control</a><ul>
<li class="chapter" data-level="4.1" data-path="version-control.html"><a href="version-control.html#name-conventions"><i class="fa fa-check"></i><b>4.1</b> Name conventions</a></li>
<li class="chapter" data-level="4.2" data-path="version-control.html"><a href="version-control.html#commit-best-practices"><i class="fa fa-check"></i><b>4.2</b> Commit best practices</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="packaging-projects.html"><a href="packaging-projects.html"><i class="fa fa-check"></i><b>5</b> Packaging projects</a></li>
<li class="chapter" data-level="6" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>6</b> Resources</a><ul>
<li class="chapter" data-level="6.1" data-path="resources.html"><a href="resources.html#setting-up-your-mac-or-linux-machines"><i class="fa fa-check"></i><b>6.1</b> Setting up your Mac or Linux Machines</a></li>
<li class="chapter" data-level="6.2" data-path="resources.html"><a href="resources.html#online-learning-materials"><i class="fa fa-check"></i><b>6.2</b> Online Learning Materials</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/datasciencecampus/coding-standards" target="blank">Source on GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science Project Coding Standards</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r" class="section level1">
<h1><span class="header-section-number">1</span> R</h1>
<p>The R programming language is one of our primary tools for deriving understanding from data. The content below provides guidance on what style to use when programming and what tools we use (and recommend) to enable you to make projects more accessible and easier to share or collaborate on.</p>
<div id="style" class="section level2">
<h2><span class="header-section-number">1.1</span> Programming Styles</h2>
<p><em>Make pretty code</em>.</p>
<p><a href="http://r-pkgs.had.co.nz/style.html">Hadley Wickham’s R Style Guide</a> should form the basis for all generated R code, this itself is based on Google’s <a href="http://google-styleguide.googlecode.com/svn/trunk/google-r-style.html">R Style Guide</a>. Some important points to note are to try to stick to 80 characters per line (exceptions are made for <code>.Rmd</code> files or similar) and to use 2 spaces, not tabs, for indentation. With regards to naming conventions, some people prefer <code>snake_case</code> where as others prefer <code>camelCase</code>; generally speaking either are fine so long as you and any collaborators are consistent with your code.</p>
<p>Some quick notes on what <em>not</em> to do when programming in R:</p>
<ul>
<li>Do not use <code>attach()</code></li>
<li>Do not use <code>1:length(x)</code> when writing loops - prefer <code>seq_along()</code></li>
<li>Do not use <code>require()</code>, <a href="https://yihui.name/en/2014/07/library-vs-require/">unless you need to</a></li>
</ul>
<p>Good coding style is like using correct punctuation. You can manage without it, but it sure makes things easier to read. As with styles of punctuation, there are many possible variations. The following guide describes the style that I use (in this book and elsewhere).</p>
<p>Good style is important because while your code only has one author, it’ll usually have multiple readers. This is especially true when you’re writing code with others. In that case, it’s a good idea to agree on a common style up-front. Since no style is strictly better than another, working with others may mean that you’ll need to sacrifice some preferred aspects of your style.</p>
<p>The <code>formatR</code> package, by Yihui Xie, makes it easier to clean up poorly formatted code. It can’t do everything, but it can quickly get your code from terrible to pretty good. Make sure to read <a href="https://yihui.name/formatR/">the notes</a> before using it.</p>
<div id="notation-and-naming" class="section level4 unnumbered">
<h4>Notation and naming</h4>
<div id="file-names" class="section level5 unnumbered">
<h5>File names</h5>
<p>File names should be meaningful and end in <code>.R</code> (yes, uppercase).</p>
<pre><code># Good
fit_models.R
utility_functions.R

# Bad
foo.r
stuff.r</code></pre>
<p>If files need to be run in sequence, prefix them with numbers:</p>
<pre><code>0_download.R
1_parse.R
2_explore.R</code></pre>
<p>Pay attention to capitalization, since you, or some of your collaborators, might be using an operating system with a case-insensitive file system (e.g., Microsoft Windows or OS X) which can lead to problems with (case-sensitive) revision control systems. Never use filenames that differ only in capitalisation.</p>
</div>
</div>
<div id="object-names" class="section level4 unnumbered">
<h4>Object names</h4>
<blockquote>
<p>“There are only two hard things in Computer Science: cache invalidation and naming things.”</p>
<p>— Phil Karlton</p>
</blockquote>
<p>Variable and function names should be lowercase. Use an underscore (<code>_</code>) to separate words within a name. Generally, variable names should be nouns and function names should be verbs. Strive for names that are concise and meaningful (this is not easy!).</p>
<p>Although standard R uses dots extensively in function names (<code>contrib.url()</code>), methods (<code>all.equal</code>), or class names (<code>data.frame</code>), it’s better to use underscores. For example, the basic S3 scheme to define a method for a class, using a generic function, would be to concatenate them with a dot, like this <code>generic.class</code>. This can lead to confusing methods like <code>as.data.frame.data.frame()</code> whereas something like <code>print.my_class()</code> is unambiguous.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Good</span>
day_one
day_1

<span class="co"># Bad</span>
first_day_of_the_month
DayOne
dayone
djm1</code></pre></div>
<p>Where possible, avoid using names of existing functions and variables. This will cause confusion for the readers of your code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Bad</span>
T &lt;-<span class="st"> </span><span class="ot">FALSE</span>
c &lt;-<span class="st"> </span><span class="dv">10</span>
mean &lt;-<span class="st"> </span>function(x) <span class="kw">sum</span>(x)</code></pre></div>
</div>
<div id="syntax" class="section level4 unnumbered">
<h4>Syntax</h4>
<div id="spacing" class="section level5 unnumbered">
<h5>Spacing</h5>
<p>Place spaces around all infix operators (<code>=</code>, <code>+</code>, <code>-</code>, <code>&lt;-</code>, etc.). The same rule applies when using <code>=</code> in function calls. Always put a space after a comma, and never before (just like in regular English). There’s a small exception to this rule: <code>:</code>, <code>::</code> and <code>:::</code> don’t need spaces around them.</p>
<p>Place a space before left parentheses, except in a function call. Extra spacing (i.e., more than one space in a row) is ok if it improves alignment of equal signs or assignments (<code>&lt;-</code>).</p>
<p>Do not place spaces around code in parentheses or square brackets (unless there’s a comma, in which case see above).</p>
</div>
<div id="curly-braces" class="section level5 unnumbered">
<h5>Curly braces</h5>
<p>An opening curly brace should never go on its own line and should always be followed by a new line. A closing curly brace should always go on its own line, unless it’s followed by <code>else</code> (or a closing parenthesis).</p>
<p>Always indent the code inside curly braces. When indenting your code, use two spaces. Never use hard tabs (most editors allow you to replace tabs with a set number of spaces so you can still use the tab key).</p>
<p>It’s ok to leave very short statements on the same line:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (y &lt;<span class="st"> </span><span class="dv">0</span> &amp;&amp;<span class="st"> </span>debug) <span class="kw">message</span>(<span class="st">&quot;Y is negative&quot;</span>)</code></pre></div>
<p>but try to avoid having more than two statements on one line</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># BAD</span>
if (y &lt;<span class="st"> </span><span class="dv">0</span> &amp;&amp;<span class="st"> </span>debug) <span class="kw">message</span>(<span class="st">&quot;Y is negative&quot;</span>); x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>); x +<span class="st"> </span><span class="dv">10</span></code></pre></div>
</div>
<div id="pipes" class="section level5 unnumbered">
<h5>Pipes</h5>
<p>If you use the <code>%&gt;%</code> operator from the tidyverse, put each verb on its own line. This makes it simpler to rearrange them later, and makes it harder to overlook a step. It is ok to keep a one-step pipe in one line.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Good</span>
iris %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(Species) %&gt;%
<span class="st">  </span><span class="kw">summarize_all</span>(mean) %&gt;%
<span class="st">  </span>ungroup %&gt;%
<span class="st">  </span><span class="kw">gather</span>(measure, value, -Species) %&gt;%
<span class="st">  </span><span class="kw">arrange</span>(value)

iris %&gt;%<span class="st"> </span><span class="kw">arrange</span>(Petal.Width)

<span class="co"># Bad</span>
iris %&gt;%<span class="st"> </span><span class="kw">group_by</span>(Species) %&gt;%<span class="st"> </span><span class="kw">summarize_all</span>(mean) %&gt;%
<span class="st">  </span>ungroup %&gt;%<span class="st"> </span><span class="kw">gather</span>(measure, value, -Species) %&gt;%
<span class="st">  </span><span class="kw">arrange</span>(value)</code></pre></div>
</div>
<div id="line-length" class="section level5 unnumbered">
<h5>Line length</h5>
<p>Strive to limit your code to 80 characters per line. This fits comfortably on a printed page with a reasonably sized font. If you find yourself running out of room, this is a good indication that you should encapsulate some of the work in a separate function.</p>
</div>
<div id="assignment" class="section level5 unnumbered">
<h5>Assignment</h5>
<p>Use <code>&lt;-</code>, not <code>=</code>, for assignment.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Good</span>
x &lt;-<span class="st"> </span><span class="dv">5</span>

<span class="co"># Bad</span>
x =<span class="st"> </span><span class="dv">5</span></code></pre></div>
</div>
<div id="quotes" class="section level5 unnumbered">
<h5>Quotes</h5>
<p>Use <code>&quot;</code>, not <code>'</code>, for quoting text. The only exception is when the text already contains double quotes and no single quotes.</p>
</div>
</div>
<div id="functions" class="section level4 unnumbered">
<h4>Functions</h4>
<ul>
<li>Should be verbs, where possible.</li>
<li>Only use <code>return()</code> for early returns.</li>
<li>Strive to keep blocks within a function on one screen, so around 20-30 lines maximum. Some even argue that if a <em>function</em> has 20 lines it should be split into smaller functions but we do not mandate this.</li>
</ul>
</div>
<div id="commenting-guidelines" class="section level4 unnumbered">
<h4>Commenting guidelines</h4>
<p>Comment your code. Each line of a comment should begin with the comment (‘pound’) symbol, <code>#</code> and a single space: <code>#</code>. Comments should explain the why, not the what.</p>
<p>Use commented lines of <code>-</code> and <code>=</code> to break up your file into easily readable chunks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load data ---------------------------</span>
df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;foo.csv&#39;</span>)

<span class="co"># Plot data ---------------------------</span>
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>foo, <span class="dt">y=</span>bar)) +<span class="st"> </span><span class="kw">geom_line</span>()</code></pre></div>
</div>
</div>
<div id="tools" class="section level2">
<h2><span class="header-section-number">1.2</span> Tools</h2>
<p>The <a href="https://github.com/jimhester/lintr"><code>lintr</code></a> package is designed to help you stick to certain coding conventions. <code>lintr</code> can be executed as standalone or as part of build. Using <code>lintr</code> will ensure we are all conforming to the same coding standards. Additionally, <code>lintr</code> can be <a href="https://github.com/jimhester/lintr#testthat">ran as part of</a> your <a href="r.html#tests-r"><code>testthat</code> tests</a> and integrates well with RStudio and external editors such as Emacs (with <a href="http://www.flycheck.org/en/latest/">flycheck</a>).</p>
<p>Quick formatting to code can be applied using the <a href="https://yihui.name/formatr/"><code>formatR</code></a> package. The <code>formatR</code> package was designed to reformat R code to improve readability; the main workhorse is the function <code>tidy_source()</code>. Features include:</p>
<ul>
<li>long lines of code and comments are reorganized into appropriately shorter ones</li>
<li>spaces and indent are added where necessary</li>
<li>the number of spaces to indent the code (i.e. tab width) can be specified</li>
<li>an else statement in a separate line without the leading <code>}</code> will be moved one line back</li>
<li><code>=</code> as an assignment operator can be replaced with <code>&lt;-</code></li>
</ul>
<p>Note that not all aspects of this may match the guidance we have provided above but it can at least begin to help you to refactor your code to be more accessible.</p>
<p>The <a href="https://github.com/MangoTheCat/goodpractice"><code>goodpractice</code></a> is useful for giving advice about good practices when <a href="r.html#package-r">building R packages</a>. Advice includes functions and syntax to avoid, package structure, code complexity, code formatting (using <code>lintr</code>) and more.</p>
</div>
<div id="docs-r" class="section level2">
<h2><span class="header-section-number">1.3</span> Documentating Code</h2>
<p>Documenting our code is an essential part of what we do. We should document our code to the point where someone else can view it and understand how it works and why. Documentation is also useful for future-you (so you remember what your functions were supposed to do), and for developers extending your code. When documenting functions in R, it is standard practice to use the <a href="https://cran.r-project.org/web/packages/roxygen2/index.html"><code>Roxygen2</code></a> package which not only helps to generate your manual (<code>.Rd</code>) files, but also manages your <code>NAMESPACE</code> file and the <code>Collate</code> field of the <code>DESCRIPTION</code> file. This integrates really nicely with R <a href="r.html#package-r">package building</a>. For more information on Roxygen2, see the Manual section of the <a href="http://r-pkgs.had.co.nz/man.html">R packages</a> book and the vignettes on the <a href="https://cran.r-project.org/web/packages/roxygen2/index.html">CRAN</a> package page.</p>
</div>
<div id="tests-r" class="section level2">
<h2><span class="header-section-number">1.4</span> Testing</h2>
<p>In <a href="https://en.wikipedia.org/wiki/Functional_programming">functional programming</a>, code is designed to be reused again and again with different inputs, making for simpler code that is easier to understand and audit. Writing functions allows us to more easily <a href="#docs">document</a> our code meaning that others can use it without too much hassle. It also means that we can build tests to ensure the code continues to work as expected when we make changes to it.</p>
<p>Everytime you write a new function, you should strive to write tests for that function. In fact, some people use a <a href="https://en.wikipedia.org/wiki/Test-driven_development">test driven development</a> approach whereby tests are written first and a function is written second to pass those tests. In the case a bug is discovered with a function, a test should <em>always</em> be written to ensure that bug is not reintroduced at some point in the future - you are essentially protecting yourself from future you’s mistakes.</p>
<p>There are different packages that help with writing and running tests in R such as <a href="https://cran.r-project.org/web/packages/RUnit/index.html"><code>RUnit</code></a> and <a href="https://github.com/hadley/testthat"><code>testthat</code></a>. It is the latter that is generally recommended. More information about <code>testthat</code> can be found in the <a href="http://r-pkgs.had.co.nz/tests.html">R packages</a> book.</p>
</div>
<div id="coverage-r" class="section level2">
<h2><span class="header-section-number">1.5</span> Code Coverage</h2>
<p>Writing tests for our code we can ensure that it works as expected and check when changes to that code break pre-existing functionality. But how do we know whether we have tested each possible scenario for our functions? How do we know which lines of code are ran during our tests? This is where code coverage comes in. Code coverage is a measure of the amount of code being exercised by a set of tests. It is an indirect measure of test quality and completeness.</p>
<p>For example, in the code below, we can see that lines 112-115 and 117-120 are not explicitly tested. In this case, we probably don’t need to worry very much, but on other occasions this might prompt us to write more tests.</p>
<div class="figure" style="text-align: center"><span id="fig:codecov"></span>
<img src="rsrc/img/code_coverage.png" alt="Code Coverage" width="80%" />
<p class="caption">
Figure 1.1: Code Coverage
</p>
</div>
<blockquote>
<p>Measuring code coverage allows developers to asses their progress in quality checking their own (or their collaborators) code. Measuring code coverage allows code consumers to have confidence in the measures taken by the package authors to verify high code quality. – <a href="https://cran.r-project.org/web/packages/covr/vignettes/how_it_works.html#introduction">Jim Hester</a></p>
</blockquote>
<div id="coverage-services" class="section level4 unnumbered">
<h4>Coverage Services</h4>
<ul>
<li><a href="http://codecov.io">Codecov</a></li>
<li><a href="http://coveralls.io">Coveralls</a></li>
</ul>
<p>In R we can obtain this functionality by using <a href="https://github.com/jimhester/covr"><code>covr</code></a>. This allows the user to track and report code coverage for your package and (optionally) upload the results to a <a href="#codecov">coverage service</a> like Codecov or Coveralls. <code>covr</code> works with both <code>RUnit</code> and <code>testthat</code>, though we are <a href="#tests">using <code>testthat</code> for our tests</a>. <code>covr</code> provides three functions to calculate test coverage:</p>
<ul>
<li><code>package_coverage()</code> performs coverage calculation on an R package (unit tests must be contained in the “tests” directory)</li>
<li><code>file_coverage()</code> performs coverage calculation on one or more R scripts by executing one or more R scripts.</li>
<li><code>function_coverage()</code> performs coverage calculation on a single named function, using an expression provided</li>
</ul>
<p>Please read the <a href="https://cran.r-project.org/web/packages/covr/vignettes/how_it_works.html">documentation</a> for more information on how <code>covr</code> works.</p>
</div>
</div>
<div id="package-r" class="section level2">
<h2><span class="header-section-number">1.6</span> Code Packaging</h2>
<p>When writing code for a project, that code should ideally be held within a self contained package or series of packages. This helps to manage <a href="r.html#deps-r">dependencies</a> on other packages, <a href="r.html#tests-r">code testing</a>, <a href="r.html#docs-r">documentation</a> and more.</p>
<p>For R, there is one major resource that you should make yourself familiar with: <a href="http://r-pkgs.had.co.nz/" class="uri">http://r-pkgs.had.co.nz/</a>. This book should cover all the essentials you will need to know in order to write an R package. Once you have mastered this book, you may wish to consider the <a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html">Writing R Extensions</a> manual, though this is a heavy read. When writing R packages, you should continually check the results of your <code>R CMD check</code> and remove any <code>NOTE</code>s, <code>WARNING</code>s and <code>ERROR</code>s, where possible. We should not ship broken code!</p>
</div>
<div id="deps-r" class="section level2">
<h2><span class="header-section-number">1.7</span> Dependency Management</h2>
<p>Dependency management systems are incredibly important, particularly in the world of analysis. Whenever we produce some code to perform statistical analysis or machine learning, we need to be able to recreate those results exactly. This could be the day after or the year after and we need to know which versions of which packages we must have installed on our machine. Updates to packages can produce breaking changes and our code may produce slightly different results, or worse yet, not run at all. Then installing a specific packages for a certain project may make code on other projects break.</p>
<blockquote class="twitter-tweet tw-align-center" data-lang="en-gb">
<p lang="en" dir="ltr">
That results can change so much with different pkg versions is scary (and ignored by many) <a href="https://t.co/wn5x3UBgQz">https://t.co/wn5x3UBgQz</a> <a href="https://twitter.com/hashtag/rstats?src=hash">#rstats</a> <a href="https://twitter.com/hashtag/reproducibility?src=hash">#reproducibility</a> <a href="https://t.co/Jp4ASOKC81">pic.twitter.com/Jp4ASOKC81</a>
</p>
— F Rodriguez-Sanchez (<span class="citation">@frod_san</span>) <a href="https://twitter.com/frod_san/status/847085478469947392">29 March 2017</a>
</blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>Moreover, you may be presented with someone else’s code but without them explicitly stating which packages you need, it is not always obvious, and even then you still have the manual challenge of installing the correct versions of each package yourself. These packages may then end up being globally installed when you don’t need them for any other project, therefore clogging up your system.</p>
<p>Whilst we would recommend docker for project management it is not always the best choice. Whilst keeping track of dependencies in R can be a chore, particularly when using lots of different packages such as those belonging to the <code>tidyverse</code> there are different packages which aim to help with this.</p>
<div id="description-file" class="section level4">
<h4><span class="header-section-number">1.7.0.1</span> <code>DESCRIPTION</code> file</h4>
<p>This is the most basic way of maintanining dependencies in R, though it is not recommended - it is only part of the dependency management system you should employ. Each R package will have a <code>DESCRIPTION</code> file which should contain a list of packages your package <code>Depends</code> on, <code>Imports</code> and <code>Suggests</code>. You can specify certain versions within for each of these.</p>
</div>
<div id="namespace-file" class="section level4">
<h4><span class="header-section-number">1.7.0.2</span> <code>NAMESPACE</code> file</h4>
<p>Dependencies in R packages are maintained using the <code>NAMESPACE</code> file. You should never write these files by hand as they are tedious to maintain and this approach is prone to error. Instead, you should consider using the <code>Roxygen2</code> package which is detailed in the <a href="r.html#docs-r">Code Documentation</a> section of this report.</p>
</div>
<div id="the-packrat-library" class="section level4">
<h4><span class="header-section-number">1.7.0.3</span> The <code>packrat</code> library</h4>
<p><a href="https://rstudio.github.io/packrat/"><code>packrat</code></a> is a dependency management system for R. Use packrat to make your R projects more:</p>
<ul>
<li>Isolated: Installing a new or updated package for one project won’t break your other projects, and vice versa. That’s because <code>packrat</code> gives each project its own private package library.</li>
<li>Portable: Easily transport your projects from one computer to another, even across different platforms. <code>packrat</code> makes it easy to install the packages your project depends on.</li>
<li>Reproducible: <code>packrat</code> records the exact package versions you depend on, and ensures those exact versions are the ones that get installed wherever you go.</li>
</ul>
<p>See the <a href="http://rstudio.github.io/packrat/">project page</a> for more information.</p>
</div>
<div id="the-pkgsnap-library" class="section level4">
<h4><span class="header-section-number">1.7.0.4</span> The <code>pkgsnap</code> library</h4>
<p><a href="https://github.com/mangothecat/pkgsnap"><code>pkgsnap</code></a> is a more lightweight alternative to <code>packrat</code> which allows you to backup and restore certain CRAN package versions. <code>pkgsnap</code> will create a snapshot of your installed CRAN packages with <code>snap()</code>, and then use <code>restore()</code> on another system to recreate exactly the same environment. Unfortunately <code>pkgsnap</code> isn’t heavily developed.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="python.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "none"
}
});
});
</script>

</body>

</html>
