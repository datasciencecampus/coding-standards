<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Data Science Campus Project Standards</title>
  <meta name="description" content="Data Science Campus Project Standards">
  <meta name="generator" content="bookdown 0.3.16 and GitBook 2.6.7">

  <meta property="og:title" content="Data Science Campus Project Standards" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="datasciencecampus/workflow" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Science Campus Project Standards" />
  
  
  

<meta name="author" content="Nathan Eastwood">


<meta name="date" content="2017-04-10">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="package.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="custom.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DSC Coding Standards</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="Intro.html"><a href="Intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="style.html"><a href="style.html"><i class="fa fa-check"></i><b>2</b> Programming Styles</a><ul>
<li class="chapter" data-level="2.1" data-path="style.html"><a href="style.html#github"><i class="fa fa-check"></i><b>2.1</b> GitHub</a></li>
<li class="chapter" data-level="2.2" data-path="style.html"><a href="style.html#r"><i class="fa fa-check"></i><b>2.2</b> R</a><ul>
<li class="chapter" data-level="2.2.1" data-path="style.html"><a href="style.html#tools"><i class="fa fa-check"></i><b>2.2.1</b> Tools</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="style.html"><a href="style.html#python"><i class="fa fa-check"></i><b>2.3</b> Python</a><ul>
<li class="chapter" data-level="2.3.1" data-path="style.html"><a href="style.html#style-guide"><i class="fa fa-check"></i><b>2.3.1</b> Style guide</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="version-control.html"><a href="version-control.html"><i class="fa fa-check"></i><b>3</b> Version Control</a><ul>
<li class="chapter" data-level="3.1" data-path="version-control.html"><a href="version-control.html#commit-best-practices"><i class="fa fa-check"></i><b>3.1</b> Commit best practices</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="docs.html"><a href="docs.html"><i class="fa fa-check"></i><b>4</b> Code Documentation</a><ul>
<li class="chapter" data-level="4.1" data-path="docs.html"><a href="docs.html#r-1"><i class="fa fa-check"></i><b>4.1</b> R</a></li>
<li class="chapter" data-level="4.2" data-path="docs.html"><a href="docs.html#python-1"><i class="fa fa-check"></i><b>4.2</b> Python</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tests.html"><a href="tests.html"><i class="fa fa-check"></i><b>5</b> Code Testing</a><ul>
<li class="chapter" data-level="5.1" data-path="tests.html"><a href="tests.html#r-2"><i class="fa fa-check"></i><b>5.1</b> R</a></li>
<li class="chapter" data-level="5.2" data-path="tests.html"><a href="tests.html#python-2"><i class="fa fa-check"></i><b>5.2</b> Python</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="automated-testing.html"><a href="automated-testing.html"><i class="fa fa-check"></i><b>6</b> Automated Testing</a></li>
<li class="chapter" data-level="7" data-path="code-coverage.html"><a href="code-coverage.html"><i class="fa fa-check"></i><b>7</b> Code Coverage</a><ul>
<li class="chapter" data-level="7.1" data-path="code-coverage.html"><a href="code-coverage.html#codecov"><i class="fa fa-check"></i><b>7.1</b> Coverage Services</a></li>
<li class="chapter" data-level="7.2" data-path="code-coverage.html"><a href="code-coverage.html#r-3"><i class="fa fa-check"></i><b>7.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="package.html"><a href="package.html"><i class="fa fa-check"></i><b>8</b> Code Packaging</a><ul>
<li class="chapter" data-level="8.1" data-path="package.html"><a href="package.html#r-4"><i class="fa fa-check"></i><b>8.1</b> R</a></li>
<li class="chapter" data-level="8.2" data-path="package.html"><a href="package.html#python-3"><i class="fa fa-check"></i><b>8.2</b> Python</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="deps.html"><a href="deps.html"><i class="fa fa-check"></i><b>9</b> Dependency Management</a><ul>
<li class="chapter" data-level="9.1" data-path="deps.html"><a href="deps.html#docker"><i class="fa fa-check"></i><b>9.1</b> Docker</a></li>
<li class="chapter" data-level="9.2" data-path="deps.html"><a href="deps.html#r-5"><i class="fa fa-check"></i><b>9.2</b> R</a><ul>
<li class="chapter" data-level="9.2.1" data-path="deps.html"><a href="deps.html#description-file"><i class="fa fa-check"></i><b>9.2.1</b> <code>DESCRIPTION</code> file</a></li>
<li class="chapter" data-level="9.2.2" data-path="deps.html"><a href="deps.html#namespace-file"><i class="fa fa-check"></i><b>9.2.2</b> <code>NAMESPACE</code> file</a></li>
<li class="chapter" data-level="9.2.3" data-path="deps.html"><a href="deps.html#packrat"><i class="fa fa-check"></i><b>9.2.3</b> packrat</a></li>
<li class="chapter" data-level="9.2.4" data-path="deps.html"><a href="deps.html#pkgsnap"><i class="fa fa-check"></i><b>9.2.4</b> pkgsnap</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="deps.html"><a href="deps.html#python-4"><i class="fa fa-check"></i><b>9.3</b> Python</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/datasciencecampus/coding-standards" target="blank">Source on GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science Campus Project Standards</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="deps" class="section level1">
<h1><span class="header-section-number">9</span> Dependency Management</h1>
<p>Dependency management systems are incredibly important, particularly in the world of analysis. Whenever we produce some code to perform statistical analysis or machine learning, we need to be able to recreate those results exactly. This could be the day after or the year after and we need to know which versions of which packages we must have installed on our machine. Updates to packages can produce breaking changes and our code may produce slightly different results, or worse yet, not run at all. Then installing a specific packages for a certain project may make code on other projects break.</p>
<blockquote class="twitter-tweet tw-align-center" data-lang="en-gb">
<p lang="en" dir="ltr">
That results can change so much with different pkg versions is scary (and ignored by many) <a href="https://t.co/wn5x3UBgQz">https://t.co/wn5x3UBgQz</a> <a href="https://twitter.com/hashtag/rstats?src=hash">#rstats</a> <a href="https://twitter.com/hashtag/reproducibility?src=hash">#reproducibility</a> <a href="https://t.co/Jp4ASOKC81">pic.twitter.com/Jp4ASOKC81</a>
</p>
— F Rodriguez-Sanchez (<span class="citation">@frod_san</span>) <a href="https://twitter.com/frod_san/status/847085478469947392">29 March 2017</a>
</blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>Moreover, you may be presented with someone else’s code but without them explicitly stating which packages you need, it is not always obvious, and even then you still have the manual challenge of installing the correct versions of each package yourself. These packages may then end up being globally installed when you don’t need them for any other project, therefore clogging up your system.</p>
<div id="docker" class="section level2">
<h2><span class="header-section-number">9.1</span> Docker</h2>
<ul>
<li><a href="https://github.com/rocker-org/rocker">Rocker</a></li>
</ul>
</div>
<div id="r-5" class="section level2">
<h2><span class="header-section-number">9.2</span> R</h2>
<p>Keeping track of dependencies in R can be a chore, particularly when using lots of different packages such as those belonging to the <code>tidyverse</code>. There are however different packages which aim to help with this.</p>
<div id="description-file" class="section level3">
<h3><span class="header-section-number">9.2.1</span> <code>DESCRIPTION</code> file</h3>
<p>This is the most basic way of maintanining dependencies in R, though it is not recommended - it is only part of the dependency management system you should employ. Each R package will have a <code>DESCRIPTION</code> file which should contain a list of packages your package <code>Depends</code> on, <code>Imports</code> and <code>Suggests</code>. You can specify certain versions within for each of these.</p>
</div>
<div id="namespace-file" class="section level3">
<h3><span class="header-section-number">9.2.2</span> <code>NAMESPACE</code> file</h3>
<p>Dependencies in R packages are maintained using the <code>NAMESPACE</code> file. You should never write these files by hand as they are tedious to maintain and this approach is prone to error. Instead, you should consider using the <code>Roxygen2</code> package which is detailed in the <a href="docs.html#docs">Code Documentation</a> section of this report.</p>
</div>
<div id="packrat" class="section level3">
<h3><span class="header-section-number">9.2.3</span> packrat</h3>
<p><a href="https://rstudio.github.io/packrat/"><code>packrat</code></a> is a dependency management system for R. Use packrat to make your R projects more:</p>
<ul>
<li>Isolated: Installing a new or updated package for one project won’t break your other projects, and vice versa. That’s because <code>packrat</code> gives each project its own private package library.</li>
<li>Portable: Easily transport your projects from one computer to another, even across different platforms. <code>packrat</code> makes it easy to install the packages your project depends on.</li>
<li>Reproducible: <code>packrat</code> records the exact package versions you depend on, and ensures those exact versions are the ones that get installed wherever you go.</li>
</ul>
<p>See the <a href="http://rstudio.github.io/packrat/">project page</a> for more information.</p>
</div>
<div id="pkgsnap" class="section level3">
<h3><span class="header-section-number">9.2.4</span> pkgsnap</h3>
<p><a href="https://github.com/mangothecat/pkgsnap"><code>pkgsnap</code></a> is a more lightweight alternative to <code>packrat</code> which allows you to backup and restore certain CRAN package versions. <code>pkgsnap</code> will create a snapshot of your installed CRAN packages with <code>snap()</code>, and then use <code>restore()</code> on another system to recreate exactly the same environment. Unfortunately <code>pkgsnap</code> isn’t heavily developed.</p>
</div>
</div>
<div id="python-4" class="section level2">
<h2><span class="header-section-number">9.3</span> Python</h2>

<p>We must be careful when looping in R. Let us say that we have a function that produces a vector which we loop over. Now let us say that somewhere within our function, something went wrong and that vector has become <code>NULL</code> or something similarly unexpected such as <code>numeric()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="ot">NULL</span></code></pre></div>
<p>What happens if we loop over this vector using <code>1:length(x)</code>?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)) {
  <span class="kw">print</span>(i)
}</code></pre></div>
<pre><code>## [1] 1
## [1] 0</code></pre>
<p>We see here that <code>length(x)</code> is 0 (which we would expect since <code>x</code> is <code>NULL</code>) but this could potentially be unexpected behaviour in our function. We must watch for any <code>0</code> or negative values if we are indexing on a vector or dataframe, etc. Rather than using <code>1:length(x)</code>, we can use the <code>seq_along()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(x)) {
  <span class="kw">print</span>(i)
}</code></pre></div>
<p>We see here that nothing actually happens. This is because <code>i</code> does not exist.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seq_along</span>(x)</code></pre></div>
<pre><code>## integer(0)</code></pre>
<p>Another example would be if we were looping over a dataframe. Let’s say we have an empty dataframe.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">a =</span> <span class="kw">numeric</span>(), <span class="dt">b =</span> <span class="kw">numeric</span>())
df</code></pre></div>
<pre><code>## [1] a b
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<p>In this instance, we need to use the <code>seq_len()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_len</span>(<span class="kw">nrow</span>(df))) {
  <span class="kw">print</span>(i) <span class="co"># doesn&#39;t print anything</span>
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_len</span>(<span class="kw">nrow</span>(df))) {
  <span class="kw">print</span>(i)
}</code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="package.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "none"
}
});
});
</script>

</body>

</html>
